@model List<LDMS.ViewModels.Menu.NavigationMenu>
    <div class="card-no-border" style="margin-left:-15px;margin-top:-15px;margin-right:-15px;">
        @foreach (var item in Model)
        { 
                <div class="card-header">
                    <a data-toggle="collapse" class="toggle" href="#" id="@item.MenuID" style="color:#000000;cursor:pointer">@item.MenuName &nbsp;&nbsp;<span class="pull-right"> <i id="icon-@item.MenuID" class="fas fa-angle-down"></i></span></a>
                </div>
                <ul class="list-group list-group-flush collapse" style="padding-left:10px;" id="collapse_@item.MenuID">
                    @foreach (var itm in item.SubMenus)
                    {
                        <li style="padding-left:25px">
                            <a class="waves-effect waves-dark" asp-controller="@itm.ControllerName" asp-action="@itm.ActionName" aria-expanded="false">
                                <i class="mdi mdi-gauge"></i><span class="hide-menu" style="color:#000000;cursor:pointer">@itm.MenuName</span>
                            </a>
                        </li>
                    }
                </ul> 
        }
    </div>
<script>
    (function ($) {
        "use strict";
        $(document).ready(function () {
            ReLoadMenu();
            $('.toggle').click(function () {
                SelectMenu(this.id);
            });
        })
    })(jQuery);

    function ReLoadMenu() {
        if (localStorage.menuId == null && localStorage.menuId == undefined) {
            var menuId = "MD10000";
            $(".toggle").each(function () { 
                if (menuId > this.id) {
                    menuId = this.id;
                }               
            });
            localStorage.menuId = menuId;
        }
        var cdoc = document.getElementById("collapse_" + localStorage.menuId);
        cdoc.classList.toggle('collapse');
        var ico = document.getElementById("icon-" + localStorage.menuId);
        if (ico != null) {
            ico.classList.remove('fa-angle-down');
            ico.classList.add('fa-angle-up');
        }
        //ico.setAttribute("class", "fas fa-angle-double-up"); 
    }

    function SelectMenu(menuId) {
        var doc = document.getElementById("collapse_" + menuId);
        localStorage.menuId = menuId; 
        doc.classList.toggle('collapse');
        var ico = document.getElementById("icon-" + menuId);
        if (ico != null) {
            if (ico.classList.contains('fa-angle-up')) {
                ico.classList.remove('fa-angle-up');
                ico.classList.add('fa-angle-down');
            } else {
                ico.classList.remove('fa-angle-down');
                ico.classList.add('fa-angle-up');
            } 
        }
        $(".toggle").each(function () {
            if (this.id != menuId) {
                var cdoc = document.getElementById("collapse_" + this.id);
                if (!cdoc.classList.contains('collapse')) {
                    cdoc.classList.toggle('collapse');
                };
                var ico = document.getElementById("icon-" + this.id);
                if (ico != null) {
                    if (ico.classList.contains('fa-angle-up')) {
                        ico.classList.remove('fa-angle-up');
                        ico.classList.add('fa-angle-down');
                    }
                }
            }
        }); 
    }
</script>
